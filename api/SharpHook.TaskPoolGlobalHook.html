<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
      <title>Class TaskPoolGlobalHook | SharpHook </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="Class TaskPoolGlobalHook | SharpHook ">
      
      <meta name="description" content="Represents a task pool-based implementation of .">
      <link rel="icon" href="../favicon.ico">
      <link rel="stylesheet" href="../public/docfx.min.css">
      <link rel="stylesheet" href="../public/main.css">
      <meta name="docfx:navrel" content="../toc.html">
      <meta name="docfx:tocrel" content="toc.html">
      
      <meta name="docfx:rel" content="../">
      
      
      
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./../public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="ManagedReference">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../index.html">
            <img id="logo" class="svg" src="../logo.png" alt="SharpHook">
            SharpHook
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="SharpHook.TaskPoolGlobalHook">



  <h1 id="SharpHook_TaskPoolGlobalHook" data-uid="SharpHook.TaskPoolGlobalHook" class="text-break">
Class TaskPoolGlobalHook  <a class="header-action link-secondary" title="View source" href="https://github.com/TolikPylypchuk/SharpHook/blob/main/SharpHook/TaskPoolGlobalHook.cs"><i class="bi bi-code-slash"></i></a>
  </h1>

  <div class="facts text-secondary">
    <dl><dt>Namespace</dt><dd><a class="xref" href="SharpHook.html">SharpHook</a></dd></dl>
  <dl><dt>Assembly</dt><dd>SharpHook.dll</dd></dl>
  </div>

  <div class="markdown summary"><p>Represents a task pool-based implementation of <a class="xref" href="SharpHook.IGlobalHook.html">IGlobalHook</a>.</p>
</div>
  <div class="markdown conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public sealed class TaskPoolGlobalHook : GlobalHookBase, IGlobalHook, IBasicGlobalHook, IDisposable</code></pre>
  </div>




  <dl class="typelist inheritance">
    <dt>Inheritance</dt>
    <dd>
      <div><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object">object</a></div>
      <div><a class="xref" href="SharpHook.BasicGlobalHookBase.html">BasicGlobalHookBase</a></div>
      <div><a class="xref" href="SharpHook.GlobalHookBase.html">GlobalHookBase</a></div>
      <div><span class="xref">TaskPoolGlobalHook</span></div>
    </dd>
  </dl>

  <dl class="typelist implements">
    <dt>Implements</dt>
    <dd>
      <div><a class="xref" href="SharpHook.IGlobalHook.html">IGlobalHook</a></div>
      <div><a class="xref" href="SharpHook.IBasicGlobalHook.html">IBasicGlobalHook</a></div>
      <div><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.idisposable">IDisposable</a></div>
    </dd>
  </dl>


  <dl class="typelist inheritedMembers">
    <dt>Inherited Members</dt>
    <dd>
    <div>
      <a class="xref" href="SharpHook.GlobalHookBase.html#SharpHook_GlobalHookBase_HookEnabled">GlobalHookBase.HookEnabled</a>
    </div>
    <div>
      <a class="xref" href="SharpHook.GlobalHookBase.html#SharpHook_GlobalHookBase_HookDisabled">GlobalHookBase.HookDisabled</a>
    </div>
    <div>
      <a class="xref" href="SharpHook.GlobalHookBase.html#SharpHook_GlobalHookBase_KeyTyped">GlobalHookBase.KeyTyped</a>
    </div>
    <div>
      <a class="xref" href="SharpHook.GlobalHookBase.html#SharpHook_GlobalHookBase_KeyPressed">GlobalHookBase.KeyPressed</a>
    </div>
    <div>
      <a class="xref" href="SharpHook.GlobalHookBase.html#SharpHook_GlobalHookBase_KeyReleased">GlobalHookBase.KeyReleased</a>
    </div>
    <div>
      <a class="xref" href="SharpHook.GlobalHookBase.html#SharpHook_GlobalHookBase_MouseClicked">GlobalHookBase.MouseClicked</a>
    </div>
    <div>
      <a class="xref" href="SharpHook.GlobalHookBase.html#SharpHook_GlobalHookBase_MousePressed">GlobalHookBase.MousePressed</a>
    </div>
    <div>
      <a class="xref" href="SharpHook.GlobalHookBase.html#SharpHook_GlobalHookBase_MouseReleased">GlobalHookBase.MouseReleased</a>
    </div>
    <div>
      <a class="xref" href="SharpHook.GlobalHookBase.html#SharpHook_GlobalHookBase_MouseMoved">GlobalHookBase.MouseMoved</a>
    </div>
    <div>
      <a class="xref" href="SharpHook.GlobalHookBase.html#SharpHook_GlobalHookBase_MouseDragged">GlobalHookBase.MouseDragged</a>
    </div>
    <div>
      <a class="xref" href="SharpHook.GlobalHookBase.html#SharpHook_GlobalHookBase_MouseWheel">GlobalHookBase.MouseWheel</a>
    </div>
    <div>
      <a class="xref" href="SharpHook.BasicGlobalHookBase.html#SharpHook_BasicGlobalHookBase_Run">BasicGlobalHookBase.Run()</a>
    </div>
    <div>
      <a class="xref" href="SharpHook.BasicGlobalHookBase.html#SharpHook_BasicGlobalHookBase_RunAsync">BasicGlobalHookBase.RunAsync()</a>
    </div>
    <div>
      <a class="xref" href="SharpHook.BasicGlobalHookBase.html#SharpHook_BasicGlobalHookBase_Stop">BasicGlobalHookBase.Stop()</a>
    </div>
    <div>
      <a class="xref" href="SharpHook.BasicGlobalHookBase.html#SharpHook_BasicGlobalHookBase_Dispose">BasicGlobalHookBase.Dispose()</a>
    </div>
    <div>
      <a class="xref" href="SharpHook.BasicGlobalHookBase.html#SharpHook_BasicGlobalHookBase_IsRunning">BasicGlobalHookBase.IsRunning</a>
    </div>
    <div>
      <a class="xref" href="SharpHook.BasicGlobalHookBase.html#SharpHook_BasicGlobalHookBase_IsDisposed">BasicGlobalHookBase.IsDisposed</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.gettype">object.GetType()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.tostring">object.ToString()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.equals#system-object-equals(system-object)">object.Equals(object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.equals#system-object-equals(system-object-system-object)">object.Equals(object, object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.referenceequals">object.ReferenceEquals(object, object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.gethashcode">object.GetHashCode()</a>
    </div>
  </dd></dl>




  <h2 id="SharpHook_TaskPoolGlobalHook_remarks">Remarks</h2>
  <div class="markdown level0 remarks"><p>
The event handlers will run with the specified parallelism level on separate threads inside the default thread
pool for tasks. This way the hook itself will not be blocked if the handlers are long-running.
The exception is the <a class="xref" href="SharpHook.IGlobalHook.html#SharpHook_IGlobalHook_HookDisabled">HookDisabled</a> event which will run on the same thread on which the
hook itself is running since at that point it doesn't matter anymore that the hook is not blocked.
</p>
<p>
Setting <a class="xref" href="SharpHook.HookEventArgs.html#SharpHook_HookEventArgs_SuppressEvent">SuppressEvent</a> inside the handlers will have no effect as they are run
on other threads.
</p>
</div>


  <h2 class="section" id="constructors">Constructors
</h2>


  <a id="SharpHook_TaskPoolGlobalHook__ctor_" data-uid="SharpHook.TaskPoolGlobalHook.#ctor*"></a>

  <h3 id="SharpHook_TaskPoolGlobalHook__ctor_System_Int32_SharpHook_Data_GlobalHookType_SharpHook_Providers_IGlobalHookProvider_System_Boolean_" data-uid="SharpHook.TaskPoolGlobalHook.#ctor(System.Int32,SharpHook.Data.GlobalHookType,SharpHook.Providers.IGlobalHookProvider,System.Boolean)">
  TaskPoolGlobalHook(int, GlobalHookType, IGlobalHookProvider?, bool)
  <a class="header-action link-secondary" title="View source" href="https://github.com/TolikPylypchuk/SharpHook/blob/main/SharpHook/TaskPoolGlobalHook.cs"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Initializes a new instance of <a class="xref" href="SharpHook.TaskPoolGlobalHook.html">TaskPoolGlobalHook</a>.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public TaskPoolGlobalHook(int parallelismLevel = 1, GlobalHookType globalHookType = GlobalHookType.All, IGlobalHookProvider? globalHookProvider = null, bool runAsyncOnBackgroundThread = false)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>parallelismLevel</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.int32">int</a></dt>
    <dd><p>The parallelism level of event handlers.</p>
</dd>
    <dt><code>globalHookType</code> <a class="xref" href="SharpHook.Data.GlobalHookType.html">GlobalHookType</a></dt>
    <dd><p>The global hook type.</p>
</dd>
    <dt><code>globalHookProvider</code> <a class="xref" href="SharpHook.Providers.IGlobalHookProvider.html">IGlobalHookProvider</a></dt>
    <dd><p>The underlying global hook provider, or <a href="https://learn.microsoft.com/dotnet/csharp/language-reference/keywords/null">null</a> to use the default one.</p>
</dd>
    <dt><code>runAsyncOnBackgroundThread</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.boolean">bool</a></dt>
    <dd><p><a href="https://learn.microsoft.com/dotnet/csharp/language-reference/builtin-types/bool">true</a> if <a class="xref" href="SharpHook.IBasicGlobalHook.html#SharpHook_IBasicGlobalHook_RunAsync">RunAsync()</a> should run the hook on a background thread.
Otherwise, <a href="https://learn.microsoft.com/dotnet/csharp/language-reference/builtin-types/bool">false</a>.</p>
</dd>
  </dl>












  <h2 class="section" id="methods">Methods
</h2>


  <a id="SharpHook_TaskPoolGlobalHook_Dispose_" data-uid="SharpHook.TaskPoolGlobalHook.Dispose*"></a>

  <h3 id="SharpHook_TaskPoolGlobalHook_Dispose_System_Boolean_" data-uid="SharpHook.TaskPoolGlobalHook.Dispose(System.Boolean)">
  Dispose(bool)
  <a class="header-action link-secondary" title="View source" href="https://github.com/TolikPylypchuk/SharpHook/blob/main/SharpHook/TaskPoolGlobalHook.cs"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Destoys the global hook.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">protected override void Dispose(bool disposing)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>disposing</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.boolean">bool</a></dt>
    <dd><p><a href="https://learn.microsoft.com/dotnet/csharp/language-reference/builtin-types/bool">true</a> if the method is called from the <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.idisposable.dispose">Dispose()</a> method.
Otherwise, <a href="https://learn.microsoft.com/dotnet/csharp/language-reference/builtin-types/bool">false</a>.</p>
</dd>
  </dl>








  <h4 class="section" id="SharpHook_TaskPoolGlobalHook_Dispose_System_Boolean__remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p>After calling this method, the hook cannot be started again. If you want to do that, create a new instance
of <a class="xref" href="SharpHook.IGlobalHook.html">IGlobalHook</a>.</p>
</div>

  <h4 class="section">Exceptions</h4>
  <dl class="parameters">
    <dt><a class="xref" href="SharpHook.HookException.html">HookException</a></dt>
    <dd><p>Stopping the hook has failed.</p>
</dd>
  </dl>



  <a id="SharpHook_TaskPoolGlobalHook_HandleHookEvent_" data-uid="SharpHook.TaskPoolGlobalHook.HandleHookEvent*"></a>

  <h3 id="SharpHook_TaskPoolGlobalHook_HandleHookEvent_SharpHook_Data_UioHookEvent__" data-uid="SharpHook.TaskPoolGlobalHook.HandleHookEvent(SharpHook.Data.UioHookEvent@)">
  HandleHookEvent(ref UioHookEvent)
  <a class="header-action link-secondary" title="View source" href="https://github.com/TolikPylypchuk/SharpHook/blob/main/SharpHook/TaskPoolGlobalHook.cs"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Handles the hook event.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">protected override void HandleHookEvent(ref UioHookEvent e)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>e</code> <a class="xref" href="SharpHook.Data.UioHookEvent.html">UioHookEvent</a></dt>
    <dd><p>The event to handle.</p>
</dd>
  </dl>












  <h2 id="seealso">See Also</h2>
  <div class="seealso">
      <div><a class="xref" href="SharpHook.IGlobalHook.html">IGlobalHook</a></div>
      <div><a class="xref" href="SharpHook.GlobalHookBase.html">GlobalHookBase</a></div>
      <div><a class="xref" href="SharpHook.SimpleGlobalHook.html">SimpleGlobalHook</a></div>
  </div>

</article>

        <div class="contribution d-print-none">
          <a href="https://github.com/TolikPylypchuk/SharpHook/blob/main/SharpHook/TaskPoolGlobalHook.cs" class="edit-link">Edit this page</a>
        </div>


      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          <span>Created by <a href="https://tolik.io">Tolik Pylypchuk</a>. Docs made with <a href="https://dotnet.github.io/docfx">docfx</a></span>.
        </div>
      </div>
    </footer>
  </body>
</html>
